好的，以下是更新后的脚本，它考虑了您提到的两个问题：

``` shell
#!/bin/bash

# 获取当前年月日
year=$(date +%Y)
month=$(date +%m)
day=$(date +%d)

# 获取当前月份的第一天
first_day=$(date -j -f "%Y-%m-%d" "${year}-${month}-01" "+%s")

# 获取脚本所在路径
script_path=$(dirname "$0")

# 获取当前月份之前的月份列表，包括跨年的情况
previous_months=()
for ((i=1; i<=12; i++)); do
  if (( $i < $month )); then
    previous_year=$year
  else
    previous_year=$((year-1))
  fi
  previous_month=$(date -j -f "%m" "$i" "+%B")
  previous_months+=("$previous_year-$previous_month")
done

# 遍历当前月份之前的月份列表
for previous_month in "${previous_months[@]}"; do
  # 获取该月份的文件夹路径
  folder_path="$script_path/$previous_month"
  # 如果文件夹不存在，则创建文件夹
  if [ ! -d "$folder_path" ]; then
    mkdir "$folder_path"
  fi
  # 遍历该月份的所有日期
  for ((i=1; i<=31; i++)); do
    # 获取该日期的文件名
    file_name="${year}年${month}月${i}日"
    # 如果该日期在当前月份之前，并且该文件存在，则移动文件到该月份的文件夹中
    if (( $(date -j -f "%Y-%m-%d" "${year}-${month}-${i}" "+%s") < $first_day )) && [ -f "$script_path/$file_name" ]; then
      mv "$script_path/$file_name" "$folder_path"
    fi
  done
done
```

该脚本首先获取当前年月日，然后获取当前月份的第一天。接着，它获取脚本所在路径，并遍历当前月份之前的所有月份，包括跨年的情况。对于每个月份，它检查是否存在该月份的文件夹，如果不存在则创建文件夹。然后，它遍历该月份的所有日期，对于每个日期，它检查该日期是否在当前月份之前，并且该文件是否存在于脚本所在路径中，如果是，则将该文件移动到该月份的文件夹中。